{"version":3,"file":"mbway-block.js","mappings":"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","sources":["webpack://test/external window \"React\"","webpack://test/external window [\"wc\",\"wcBlocksRegistry\"]","webpack://test/external window [\"wc\",\"wcSettings\"]","webpack://test/external window [\"wp\",\"hooks\"]","webpack://test/external window [\"wp\",\"htmlEntities\"]","webpack://test/external window [\"wp\",\"i18n\"]","webpack://test/webpack/bootstrap","webpack://test/webpack/runtime/compat get default export","webpack://test/webpack/runtime/define property getters","webpack://test/webpack/runtime/hasOwnProperty shorthand","webpack://test/webpack/runtime/make namespace object","webpack://test/./woocommerce-blocks/mbway/src/index.js"],"sourcesContent":["module.exports = window[\"React\"];","module.exports = window[\"wc\"][\"wcBlocksRegistry\"];","module.exports = window[\"wc\"][\"wcSettings\"];","module.exports = window[\"wp\"][\"hooks\"];","module.exports = window[\"wp\"][\"htmlEntities\"];","module.exports = window[\"wp\"][\"i18n\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * External dependencies\n */\nimport { registerPaymentMethod } from '@woocommerce/blocks-registry';\nimport { __ } from '@wordpress/i18n';\nimport { getSetting } from '@woocommerce/settings';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport { useEffect, useState } from 'react';\nimport { applyFilters } from '@wordpress/hooks';\n\nconst settings = getSetting( 'mbway_ifthen_for_woocommerce_data', {} );\nconst defaultLabel = __(\n\t'MB WAY mobile payment',\n\t'multibanco-ifthen-software-gateway-for-woocommerce'\n) + ' (ifthenpay)';\nconst label = decodeEntities( settings.title ) || defaultLabel;\n\n//const [mbwayPhoneNumber, setMbwayPhoneNumber] = useState(''); //If I set it here, i get \"invalid hook call\"\n\n/**\n * Content component\n *\n * @param {*} props Props from payment API.\n */\nconst Content = ( props ) => {\n\t/* Data to send to the server - https://github.com/woocommerce/woocommerce-blocks/blob/trunk/docs/internal-developers/block-client-apis/checkout/checkout-api.md#passing-a-value-from-the-client-through-to-server-side-payment-processing */\n\tconst [ mbwayPhoneNumber, setMbwayPhoneNumber ] = useState( settings.default_number ); // This works but mbwayPhoneNumber is not available inside onPaymentProcessing below\n\tconst { eventRegistration, emitResponse } = props;\n\tconst { onPaymentProcessing } = eventRegistration;\n\tuseEffect( () => {\n\t\tconst unsubscribe = onPaymentProcessing( async () => {\n\t\t\t// Here we can do any processing we need, and then emit a response.\n\t\t\t// For example, we might validate a custom field, or perform an AJAX request, and then emit a response indicating it is valid or not.\n\t\t\tconst mbway_ifthen_for_woocommerce_phone = mbwayPhoneNumber; // This will need to be the value of the input field\n\t\t\tconst customDataIsValid = ( mbway_ifthen_for_woocommerce_phone.length === 9 );\n\n\t\t\tif ( customDataIsValid ) {\n\t\t\t\treturn {\n\t\t\t\t\ttype: emitResponse.responseTypes.SUCCESS,\n\t\t\t\t\tmeta: {\n\t\t\t\t\t\tpaymentMethodData: applyFilters( 'mbway_ifthen_blocks_checkout_payment_data', {\n\t\t\t\t\t\t\tmbway_ifthen_for_woocommerce_phone,\n\t\t\t\t\t\t} ),\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: __(\n\t\t\t\t\t'Invalid MB WAY phone number',\n\t\t\t\t\t'multibanco-ifthen-software-gateway-for-woocommerce'\n\t\t\t\t),\n\t\t\t};\n\t\t} );\n\t\t// Unsubscribes when this component is unmounted.\n\t\treturn () => {\n\t\t\tunsubscribe();\n\t\t};\n\t}, [\n\t\temitResponse.responseTypes.ERROR,\n\t\temitResponse.responseTypes.SUCCESS,\n\t\tonPaymentProcessing,\n\t\tmbwayPhoneNumber\n\t] );\n\t/* Input value */\n\tconst HandleMBWayChange = ( event ) => {\n\t\tconst value = event.target.value.replace(/\\D/g, \"\");\n\t\tsetMbwayPhoneNumber( value );\n\t};\n\t/* Content */\n\t// Description\n\tvar description = React.createElement( 'p', null, decodeEntities( settings.description || '' ) );\n\t// Input field\n\tvar phonenumberinput = React.createElement( 'input', {\n\t\ttype:         'tel',\n\t\tname:         settings.id+'_phone',\n\t\tid:           settings.id+'_phone',\n\t\tplaceholder:  '9xxxxxxxx',\n\t\tautoComplete: 'off',\n\t\tmaxLength:    '9',\n\t\trequired:     true,\n\t\tvalue:        mbwayPhoneNumber,\n\t\tonChange:     HandleMBWayChange\n\t} );\n\t// Label inside field\n\tvar phonenumberlabel = React.createElement( 'label', {\n\t\thtmlFor: settings.id + '_phone'\n\t}, decodeEntities( settings.phonenumbertext || '' ) );\n\t// Extend before phone number\n\tvar beforePhoneNumber = applyFilters( 'mbway_ifthen_blocks_checkout_before_phone_number', null );\n\t// Phone number: input + label\n\tvar phonenumber = React.createElement( 'div', {\n\t\tclassName: 'wc-block-components-text-input is-active'\n\t}, '', phonenumberinput, phonenumberlabel );\n\t// Extend after phone number\n\tvar afterPhoneNumber = applyFilters( 'mbway_ifthen_blocks_checkout_after_phone_number', null );\n\t// Return Content\n\treturn React.createElement( 'div', null, description, beforePhoneNumber, phonenumber, afterPhoneNumber );\n};\n\n/**\n * Label component\n *\n * @param {*} props Props from payment API.\n */\nconst Label = ( props ) => {\n\tvar icon = React.createElement( 'img', { src: settings.icon, width: settings.icon_width, height: settings.icon_height, style: { display: 'inline' } } );\n\tvar span = React.createElement( 'span', { className: 'wc-block-components-payment-method-label wc-block-components-payment-method-label--with-icon' }, icon, decodeEntities( settings.title ) || defaultLabel );\n\treturn span;\n};\n\n\n/**\n * CanMakePayment function\n *\n * @param checkoutData Checkout details.\n */\nconst CanMakePayment = ( checkoutData ) => {\n\t//Euro?\n\tif ( checkoutData.cartTotals.currency_code != 'EUR' ) {\n\t\treturn false;\n\t}\n\t//Portugal?\n\tif ( settings.only_portugal ) {\n\t\tif ( checkoutData.billingData.country != 'PT' && checkoutData.shippingAddress.country != 'PT' ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\t//Minimum and maximum value\n\tvar cart_total = checkoutData.cartTotals.total_price / 100; //It's return in cents (?)\n\tif ( settings.only_above ) {\n\t\tif ( cart_total < settings.only_above ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\tif ( settings.only_bellow ) {\n\t\tif ( cart_total > settings.only_bellow ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\n/**\n * Payshop payment method config object.\n */\nconst ifthenpayMbWayPaymentMethod = {\n\tname: 'mbway_ifthen_for_woocommerce',\n\tlabel: React.createElement( Label, null ),\n\tcontent: React.createElement( Content, null ),\n\tedit: React.createElement( Content, null ),\n\ticons: null,\n\tcanMakePayment: CanMakePayment,\n\tariaLabel: label,\n\tsupports: {\n\t\tfeatures: settings.supports,\n\t},\n};\n\nregisterPaymentMethod( ifthenpayMbWayPaymentMethod );\n"],"names":["registerPaymentMethod","__","getSetting","decodeEntities","useEffect","useState","applyFilters","settings","defaultLabel","label","title","Content","props","mbwayPhoneNumber","setMbwayPhoneNumber","default_number","eventRegistration","emitResponse","onPaymentProcessing","unsubscribe","mbway_ifthen_for_woocommerce_phone","customDataIsValid","length","type","responseTypes","SUCCESS","meta","paymentMethodData","ERROR","message","HandleMBWayChange","event","value","target","replace","description","React","createElement","phonenumberinput","name","id","placeholder","autoComplete","maxLength","required","onChange","phonenumberlabel","htmlFor","phonenumbertext","beforePhoneNumber","phonenumber","className","afterPhoneNumber","Label","icon","src","width","icon_width","height","icon_height","style","display","span","CanMakePayment","checkoutData","cartTotals","currency_code","only_portugal","billingData","country","shippingAddress","cart_total","total_price","only_above","only_bellow","ifthenpayMbWayPaymentMethod","content","edit","icons","canMakePayment","ariaLabel","supports","features"],"sourceRoot":""}