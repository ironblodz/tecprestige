{"version":3,"file":"mbway-block.js","mappings":"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","sources":["webpack://test/external window \"React\"","webpack://test/external window [\"wc\",\"wcBlocksRegistry\"]","webpack://test/external window [\"wc\",\"wcSettings\"]","webpack://test/external window [\"wp\",\"htmlEntities\"]","webpack://test/external window [\"wp\",\"i18n\"]","webpack://test/webpack/bootstrap","webpack://test/webpack/runtime/compat get default export","webpack://test/webpack/runtime/define property getters","webpack://test/webpack/runtime/hasOwnProperty shorthand","webpack://test/webpack/runtime/make namespace object","webpack://test/./woocommerce-blocks/mbway/src/index.js"],"sourcesContent":["module.exports = window[\"React\"];","module.exports = window[\"wc\"][\"wcBlocksRegistry\"];","module.exports = window[\"wc\"][\"wcSettings\"];","module.exports = window[\"wp\"][\"htmlEntities\"];","module.exports = window[\"wp\"][\"i18n\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * External dependencies\n */\nimport { registerPaymentMethod } from '@woocommerce/blocks-registry';\nimport { __ } from '@wordpress/i18n';\nimport { getSetting } from '@woocommerce/settings';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport { useEffect, useState } from 'react';\n\nconst settings = getSetting( 'mbway_ifthen_for_woocommerce_data', {} );\nconst defaultLabel = __(\n\t'MB WAY (IfthenPay)',\n\t'multibanco-ifthen-software-gateway-for-woocommerce'\n);\nconst label = decodeEntities( settings.title ) || defaultLabel;\n\n//const [mbwayPhoneNumber, setMbwayPhoneNumber] = useState(''); //If I set it here, i get \"invalid hook call\"\n\n/**\n * Content component\n *\n * @param {*} props Props from payment API.\n */\nconst Content = ( props ) => {\n\t/* Data to send to the server - https://github.com/woocommerce/woocommerce-blocks/blob/trunk/docs/internal-developers/block-client-apis/checkout/checkout-api.md#passing-a-value-from-the-client-through-to-server-side-payment-processing */\n\tconst [mbwayPhoneNumber, setMbwayPhoneNumber] = useState(''); //This works but mbwayPhoneNumber is not available inside onPaymentProcessing below\n\tconst { eventRegistration, emitResponse } = props;\n\tconst { onPaymentProcessing } = eventRegistration;\n\tuseEffect( () => {\n\t\tconst unsubscribe = onPaymentProcessing( async () => {\n\t\t\t// Here we can do any processing we need, and then emit a response.\n\t\t\t// For example, we might validate a custom field, or perform an AJAX request, and then emit a response indicating it is valid or not.\n\t\t\tconst mbway_ifthen_for_woocommerce_phone = mbwayPhoneNumber; //This will need to be the value of the input field\n\t\t\tconst customDataIsValid = ( mbway_ifthen_for_woocommerce_phone.length == 9 );\n\n\t\t\tif ( customDataIsValid ) {\n\t\t\t\treturn {\n\t\t\t\t\ttype: emitResponse.responseTypes.SUCCESS,\n\t\t\t\t\tmeta: {\n\t\t\t\t\t\tpaymentMethodData: {\n\t\t\t\t\t\t\tmbway_ifthen_for_woocommerce_phone,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: __(\n\t\t\t\t\t'Invalid MB WAY phone number',\n\t\t\t\t\t'multibanco-ifthen-software-gateway-for-woocommerce'\n\t\t\t\t),\n\t\t\t};\n\t\t} );\n\t\t// Unsubscribes when this component is unmounted.\n\t\treturn () => {\n\t\t\tunsubscribe();\n\t\t};\n\t}, [\n\t\temitResponse.responseTypes.ERROR,\n\t\temitResponse.responseTypes.SUCCESS,\n\t\tonPaymentProcessing,\n\t\tmbwayPhoneNumber\n\t] );\n\t/* Input value */\n\tconst HandleMBWayChange = ( event ) => {\n\t\tconst value = event.target.value.replace(/\\D/g, \"\");\n\t\tsetMbwayPhoneNumber( value );\n\t};\n\t/* Content */\n\tvar description = React.createElement( 'p', null, decodeEntities( settings.description || '' ) );\n\tvar phonenumberinput = React.createElement( 'input', {\n\t\ttype:         'tel',\n\t\tname:         settings.id+'_phone',\n\t\tid:           settings.id+'_phone',\n\t\tplaceholder:  '9xxxxxxxx',\n\t\tautoComplete: 'off',\n\t\tmaxLength:    '9',\n\t\trequired:     true,\n\t\tvalue:        mbwayPhoneNumber,\n\t\tonChange:     HandleMBWayChange\n\t} );\n\tvar phonenumberlabel = React.createElement( 'label', {\n\t\thtmlFor: settings.id+'_phone'\n\t}, decodeEntities( settings.phonenumbertext || '' ) );\n\tvar phonenumber = React.createElement( 'div', {\n\t\tclassName: 'wc-block-components-text-input is-active'\n\t}, '', phonenumberinput, phonenumberlabel );\n\treturn React.createElement( 'div', null, description, phonenumber );\n};\n\n/**\n * Label component\n *\n * @param {*} props Props from payment API.\n */\nconst Label = ( props ) => {\n\tvar icon = React.createElement( 'img', { src: settings.icon, width: 28, height: 24, style: { display: 'inline' } } );\n\tvar span = React.createElement( 'span', { className: 'wc-block-components-payment-method-label wc-block-components-payment-method-label--with-icon' }, icon, decodeEntities( settings.title ) || defaultLabel );\n\treturn span;\n};\n\n\n/**\n * CanMakePayment function\n *\n * @param checkoutData Checkout details.\n */\nconst CanMakePayment = ( checkoutData ) => {\n\t//Euro?\n\tif ( checkoutData.cartTotals.currency_code != 'EUR' ) {\n\t\treturn false;\n\t}\n\t//Portugal?\n\tif ( settings.only_portugal ) {\n\t\tif ( checkoutData.billingData.country != 'PT' && checkoutData.shippingAddress.country != 'PT' ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\t//Minimum and maximum value\n\tvar cart_total = checkoutData.cartTotals.total_price / 100; //It's return in cents (?)\n\tif ( settings.only_above ) {\n\t\tif ( cart_total < settings.only_above ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\tif ( settings.only_bellow ) {\n\t\tif ( cart_total > settings.only_bellow ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\n/**\n * Payshop payment method config object.\n */\nconst ifthenpayMbWayPaymentMethod = {\n\tname: 'mbway_ifthen_for_woocommerce',\n\tlabel: React.createElement( Label, null ),\n\tcontent: React.createElement( Content, null ),\n\tedit: React.createElement( Content, null ),\n\ticons: null,\n\tcanMakePayment: CanMakePayment,\n\tariaLabel: label,\n\tsupports: {\n\t\tfeatures: settings.supports,\n\t},\n};\n\nregisterPaymentMethod( ifthenpayMbWayPaymentMethod );\n"],"names":["registerPaymentMethod","__","getSetting","decodeEntities","useEffect","useState","settings","defaultLabel","label","title","Content","props","mbwayPhoneNumber","setMbwayPhoneNumber","eventRegistration","emitResponse","onPaymentProcessing","unsubscribe","mbway_ifthen_for_woocommerce_phone","customDataIsValid","length","type","responseTypes","SUCCESS","meta","paymentMethodData","ERROR","message","HandleMBWayChange","event","value","target","replace","description","React","createElement","phonenumberinput","name","id","placeholder","autoComplete","maxLength","required","onChange","phonenumberlabel","htmlFor","phonenumbertext","phonenumber","className","Label","icon","src","width","height","style","display","span","CanMakePayment","checkoutData","cartTotals","currency_code","only_portugal","billingData","country","shippingAddress","cart_total","total_price","only_above","only_bellow","ifthenpayMbWayPaymentMethod","content","edit","icons","canMakePayment","ariaLabel","supports","features"],"sourceRoot":""}