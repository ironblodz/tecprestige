(function(a){"use strict";var r=function(t,n){var o=this;o.options=a.extend({},a.fn.quantityDropdown.defaults,n);o.$input=t;o.$quantity=o.$input.closest(".quantity");o.$form=o.$input.closest("form");o.init();o.init=o.init.bind(o);o.destroy=o.destroy.bind(o);o.refresh=o.refresh.bind(o);o.scroll=o.scroll.bind(o);o.increase=o.increase.bind(o);o.openDropdown=o.openDropdown.bind(o);o.closeDropdown=o.closeDropdown.bind(o);o.$quantity.on("click.quantity-dropdown",".qty-dropdown .current",{quantityDropdown:o},o.toggleDropdown);o.$quantity.on("click.quantity-dropdown",".qty-options li",{quantityDropdown:o},o.onSelect);o.$quantity.on("mousewheel.quantity-dropdown",".qty-options",{quantityDropdown:o},o.onScroll);o.$quantity.on("swipeup.quantity-dropdown",".qty-options",{quantityDropdown:o},o.onSwipeUp);o.$quantity.on("swipedown.quantity-dropdown",".qty-options",{quantityDropdown:o},o.onSwipeDown);if(o.$form.length){o.$form.on("found_variation.quantity-dropdown",o.onFoundVariation)}};r.prototype.init=function(){var t=this;t.$list=a("<ul/>");t.$dropdown=a('<div class="qty-dropdown"/>');t.current=parseFloat(t.$input.val());t.min=parseFloat(t.$input.attr("min"));t.max=parseFloat(t.$input.attr("max"));t.step=parseFloat(t.$input.attr("step"));t.maxItems=t.options.maxItems;t.infinite=false;t.values=[];t.visible=[];t.step=t.step?t.step:1;t.min=t.min?t.min:0;t.current=t.current?t.current:t.min;if(!t.max){t.max=Math.max(t.maxItems,t.current);t.infinite=true}else if(t.max<t.maxItems){t.maxItems=t.max}for(var n=t.min;n<=t.max;n+=t.step){if(t.current==n){a('<li class="active">'+n+"</li>").appendTo(t.$list)}else{a("<li>"+n+"</li>").appendTo(t.$list)}t.values.push(n)}t.$dropdown.append('<span class="current"><span class="value">'+t.current+'</span><span class="svg-icon icon-arrow-dropdown icon-smaller"><svg><use xlink:href="#arrow-dropdown"></use></svg></span></span>').append(t.$list).appendTo(t.$quantity);t.$list.wrap('<div class="qty-options"/>');t.$quantity.addClass("quantity-dropdown")};r.prototype.destroy=function(){this.$quantity.off(".quantity-dropdown").removeData("quantityDropdown");this.$form.off(".quantity-dropdown");this.$quantity.removeData("quantityDropdown");this.$quantity.removeClass("quantity-dropdown");this.$quantity.find(".qty-dropdown").remove();this.$dropdown.detach().remove()};r.prototype.refresh=function(){var t=this;t.$quantity.find(".qty-dropdown").detach().remove();t.$dropdown.detach().remove();t.init()};r.prototype.toggleDropdown=function(t){t.preventDefault();var n=t.data.quantityDropdown,o=a(this);n.current=parseFloat(o.find(".value").text());n.scroll();if(n.$dropdown.hasClass("opened")){n.closeDropdown()}else{n.openDropdown()}};r.prototype.openDropdown=function(){var t=this,n=t.$dropdown.find(".qty-options"),o=t.$dropdown.find(".current").outerHeight();n.css("height",t.maxItems*o);n.fadeIn();t.$dropdown.addClass("opened");a(document).on("click.quantity-dropdown",e)};r.prototype.closeDropdown=function(){this.$quantity.find(".qty-options").fadeOut();this.$dropdown.removeClass("opened")};r.prototype.onSelect=function(t){t.preventDefault();var n=t.data.quantityDropdown,o=a(this);n.current=parseFloat(o.text());o.addClass("active").siblings(".active").removeClass("active");o.closest(".qty-dropdown").find(".current .value").text(n.current);o.closest(".quantity").find(".qty").val(n.current).change();n.closeDropdown();if(typeof n.options.onChange==="function"){n.options.onChange(n)}};r.prototype.onScroll=function(t){if(t.originalEvent.wheelDelta/120>0){t.data.quantityDropdown.scroll("up")}else{t.data.quantityDropdown.increase()}return false};r.prototype.onSwipeUp=function(t){t.data.quantityDropdown.increase()};r.prototype.onSwipeDown=function(t){t.data.quantityDropdown.scroll("up")};r.prototype.scroll=function(t){var n=this,o=n.$quantity.find(".current").outerHeight(),e=Math.min.apply(null,n.visible),i=Math.max.apply(null,n.visible),a=0;if("up"===t){if(e<=n.min){return}a=-n.values.indexOf(e-n.step)*o;n.visible.pop();n.visible.unshift(e-n.step)}else if("down"===t){if(i>=n.max){return}a=-n.values.indexOf(e+n.step)*o;n.visible.shift();n.visible.push(i+1)}else{var t=t?t:n.current,r=n.values.indexOf(t),s=Math.floor(n.maxItems/2);if(r>s){r=r-s}else{r=0}n.visible=[];for(var p=r;p<r+n.maxItems;p++){if(p in n.values){n.visible.push(n.values[p])}else if(n.infinite){n.max=n.max+n.step;n.values.push(n.max);n.visible.push(n.max);n.$list.append("<li>"+n.max+"</li>")}}a=-r*o}n.$list.css("transform","translate3d(0, "+a+"px, 0)")};r.prototype.increase=function(){var t=this,n=Math.max.apply(null,t.visible);if(n>=t.max&&t.infinite){t.max+=t.step;t.values.push(t.max);t.$list.append("<li>"+t.max+"</li>")}t.scroll("down")};r.prototype.onFoundVariation=function(t){var n=a(t.target).find(".single_variation_wrap .quantity .qty");setTimeout(function(){n.quantityDropdown("refresh")},100)};a(document).on("click.quantity-dropdown",e);function e(t){var n=a(t.target).closest(".qty-dropdown");if(n.length===0){a(".qty-options").fadeOut();a(".qty-dropdown.opened").removeClass("opened");a(document).off("click.quantity-dropdown")}else{a(".qty-dropdown.opened").not(n).removeClass("opened").find(".qty-options").fadeOut()}}a.fn.quantityDropdown=function(e){var i=typeof e=="object"&&e;return this.each(function(){var t=a(this),n=t.closest(".quantity");if(!n.length){return this}var o=n.data("quantityDropdown");if(!o){o=new r(t,i);n.data("quantityDropdown",o)}if(typeof e=="string"&&typeof o[e]=="function"){o[e]()}})};a.fn.quantityDropdown.defaults={maxItems:5,onChange:null,onInit:null}})(jQuery);(function(r){function t(){var t=" -webkit- -moz- -o- -ms- ".split(" ");var n=function(t){return window.matchMedia(t).matches};if("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch){return true}var o=["(",t.join("touch-enabled),("),"heartz",")"].join("");return n(o)}var n=t(),o=n?"touchstart":"mousedown",s=n?"touchend":"mouseup",p=n?"touchmove":"mousemove";r.event.special.swipeupdown={setup:function(){var t=this;var a=r(t);a.bind(o,function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,o={time:(new Date).getTime(),coords:[n.pageX,n.pageY],origin:r(t.target)},e;function i(t){if(!o){return}var n=t.originalEvent.touches?t.originalEvent.touches[0]:t;e={time:(new Date).getTime(),coords:[n.pageX,n.pageY]};if(Math.abs(o.coords[1]-e.coords[1])>10){t.preventDefault()}}a.bind(p,i).one(s,function(t){a.unbind(p,i);if(o&&e){if(e.time-o.time<1e3&&Math.abs(o.coords[1]-e.coords[1])>30&&Math.abs(o.coords[0]-e.coords[0])<75){o.origin.trigger("swipeupdown").trigger(o.coords[1]>e.coords[1]?"swipeup":"swipedown")}}o=e=undefined})})}};r.each({swipedown:"swipeupdown",swipeup:"swipeupdown"},function(n,t){r.event.special[n]={setup:function(){r(this).bind(t,r.noop)}};r.fn[n]=function(t){return t?this.bind(n,t):this.trigger(n)}})})(jQuery);